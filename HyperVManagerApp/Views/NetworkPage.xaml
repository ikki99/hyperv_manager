<Page
    x:Class="HyperVManager.Views.NetworkPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <TextBlock Text="Hyper-V 网络管理" FontSize="24" Margin="10"/>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10" Margin="10,0,10,10">
            <Button Content="刷新" Click="OnRefreshVSwitchesClicked"/>
            <Button Content="创建交换机" Click="OnCreateVSwitchClicked"/>
            <Button Content="删除所选交换机" Click="OnDeleteVSwitchClicked"/>
        </StackPanel>
        <controls:DataGrid Grid.Row="2"
                           x:Name="VSwitchDataGrid"
                           AutoGenerateColumns="False"
                           IsReadOnly="True"
                           HeadersVisibility="Column"
                           ItemsSource="{x:Bind VSwitches, Mode=OneWay}"
                           SelectionMode="Single"
                           SelectionChanged="OnVSwitchDataGridSelectionChanged">
            <controls:DataGrid.Columns>
                <controls:DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="*"/>
                <controls:DataGridTextColumn Header="类型" Binding="{Binding SwitchType}" Width="Auto"/>
                <controls:DataGridTextColumn Header="IP 地址" Binding="{Binding IPAddress}" Width="Auto"/>
                <controls:DataGridTextColumn Header="NAT 状态" Binding="{Binding NatStatus}" Width="Auto"/>
                <controls:DataGridTextColumn Header="备注" Binding="{Binding Notes}" Width="2*"/>
            </controls:DataGrid.Columns>
        </controls:DataGrid>
        <StackPanel Grid.Row="3" x:Name="NatPanel" Visibility="Collapsed" Margin="10">
            <TextBlock Text="NAT 规则" FontSize="20" Margin="0,10,0,5"/>
            <StackPanel Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
                <Button Content="创建 NAT 网络" Click="OnCreateNatNetworkClicked"/>
                <Button Content="设置网关 IP" Click="OnSetGatewayIPClicked"/>
                <Button Content="添加端口转发" Click="OnAddNatRuleClicked"/>
                <Button Content="删除所选规则" Click="OnRemoveNatRuleClicked"/>
            </StackPanel>
            <controls:DataGrid x:Name="NatRulesDataGrid"
                               AutoGenerateColumns="False"
                               IsReadOnly="True"
                               HeadersVisibility="Column"
                               ItemsSource="{x:Bind NatRules, Mode=OneWay}">
                <controls:DataGrid.Columns>
                    <controls:DataGridTextColumn Header="协议" Binding="{Binding Protocol}" Width="Auto"/>
                    <controls:DataGridTextColumn Header="外部端口" Binding="{Binding ExternalPort}" Width="Auto"/>
                    <controls:DataGridTextColumn Header="内部 IP" Binding="{Binding InternalIPAddress}" Width="*"/>
                    <controls:DataGridTextColumn Header="内部端口" Binding="{Binding InternalPort}" Width="Auto"/>
                </controls:DataGrid.Columns>
            </controls:DataGrid>
        </StackPanel>
    </Grid>
</Page>